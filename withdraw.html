 <!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>টাকা উত্তোলন</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    <h2 class="page-title">টাকা উত্তোলন</h2>

    <div class="input-group">
        <select id="method">
            <option value="">মেথড নির্বাচন করুন</option>
            <option value="Bkash">বিকাশ</option>
            <option value="Nagad">নগদ</option>
            <option value="Rocket">রকেট</option>
        </select>
    </div>

    <div class="input-group">
        <input type="text" id="number" placeholder="অ্যাকাউন্ট নম্বর">
    </div>

    <div class="input-group">
        <input type="number" id="amount" placeholder="উত্তোলনের পরিমাণ">
    </div>

    <div class="input-group">
        <input type="password" id="pin" placeholder="উত্তোলন পিন (৪ সংখ্যা)">
    </div>

    <button class="btn-primary" onclick="withdrawNow()">উত্তোলন করুন</button>

    <p id="msg" style="margin-top:15px;font-weight:bold;"></p>

    <div class="login-link">
        <a href="home.html">← ফিরে যান</a>
    </div>
</div>

<script>
/* =========================
   Withdraw Function
========================= */
function withdrawNow() {

    let method = document.getElementById("method").value;
    let number = document.getElementById("number").value.trim();
    let amount = parseFloat(document.getElementById("amount").value);
    let pin = document.getElementById("pin").value.trim();
    let msg = document.getElementById("msg");

    let currentUser = localStorage.getItem("currentUser");
    let userData = JSON.parse(localStorage.getItem(currentUser));

    if (!method) {
        msg.innerText = "মেথড নির্বাচন করুন!";
        msg.style.color = "red";
        return;
    }

    if (!number || number.length < 6) {
        msg.innerText = "সঠিক অ্যাকাউন্ট নম্বর দিন!";
        msg.style.color = "red";
        return;
    }

    if (!amount || amount <= 0) {
        msg.innerText = "সঠিক পরিমাণ লিখুন!";
        msg.style.color = "red";
        return;
    }

    if (!pin || pin.length !== 4) {
        msg.innerText = "৪ সংখ্যার পিন দিন!";
        msg.style.color = "red";
        return;
    }

    if (pin !== userData.withdrawPin) {
        msg.innerText = "পিন ভুল!";
        msg.style.color = "red";
        return;
    }

    if (amount > userData.balance) {
        msg.innerText = "পর্যাপ্ত ব্যালেন্স নেই!";
        msg.style.color = "red";
        return;
    }

    /* ব্যালেন্স কাট */
    userData.balance -= amount;

    localStorage.setItem(currentUser, JSON.stringify(userData));

    msg.innerText =
        `✔️ ${amount}৳ উত্তোলনের অনুরোধ গ্রহণ করা হয়েছে (${method})`;
    msg.style.color = "green";

    document.getElementById("amount").value = "";
    document.getElementById("number").value = "";
    document.getElementById("pin").value = "";
}
</script>

</body>
</html>
