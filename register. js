import { auth, db } from "./firebase-config.js";
import { createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
import { ref, set } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

window.register = () => {
    const phone = document.getElementById("phone").value.trim();
    const pass = document.getElementById("password").value.trim();
    const cpass = document.getElementById("cpassword").value.trim();
    if (!phone || !pass || !cpass) return alert("à¦¸à¦¬ à¦˜à¦° à¦ªà§‚à¦°à¦£ à¦•à¦°à§à¦¨");
    if(pass !== cpass) return alert("Password à¦®à¦¿à¦²à¦›à§‡ à¦¨à¦¾");

    const email = phone + "@app.com";

    createUserWithEmailAndPassword(auth, email, pass)
    .then(user => {
        set(ref(db, "users/" + phone), {
            phone,
            balance: 0,
            joined: new Date().toLocaleString()
        });
        alert("à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦¸à¦«à¦² ğŸ‘");
        location.href = "login.html";
    })
    .catch(err => alert(err.message));
};